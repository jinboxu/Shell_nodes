## 正则表达式

#### shell元字符(通配符)与正则表达式元字符

**shell 元字符(也称为通配符)** 由 shell 来解析，如 rm -rf  \*.pdf，元字符\* Shell 将其解析为任意 多个字符 

**正则表达式元字符** 由各种执行模式匹配操作的程序来解析，比如 vi、grep、sed、awk、python 



> shell常见通配符

| 字符                 | 含义                                      |
| -------------------- | ----------------------------------------- |
| *                    | 匹配 0个或多个字符                        |
| ？                   | 匹配任意一个字符                          |
| [list]               | 匹配 list 中的任意单一字符                |
| [!list]              | 匹配 除list 中的任意单一字符              |
| [0-9a-b]             | 匹配0-9,a-b中任意字符                     |
| {string1,sring2,...} | 匹配 sring1 或 string2 (或更多)其一字符串 |

*通配符*与正则表达式不同的，不能相互混淆。把通配符理解为shell 特殊代号字符就可。而且涉及的只有\*  ?  []  {} 这几种。 

```shell
[root@localhost tmp]# ls
l7ve  liove  live  lIve  loove  love  l_ve
[root@localhost tmp]# ll l[a-z]ve
-rw-r--r-- 1 root root 0 Dec 24 20:29 live
-rw-r--r-- 1 root root 0 Dec 24 20:30 lIve     #shell元字符不区分大小写，正则严格区分
-rw-r--r-- 1 root root 0 Dec 24 20:29 love
```



> 正则表达式

**===基本正则表达式元字符**

| 元字符   | 功能                | 示例                         |
| -------- | ------------------- | ---------------------------- |
| ^        | 行首定位符          | ^love                        |
| $        | 行尾定位符          | love$                        |
| .        | 匹配单个字符        | l..e                         |
| *        | 匹配前导符0次到多次 | ab\*love                     |
| []       | 匹配范围内一个字符  | [a-z]                        |
| \        | 用来转义元字符      | love\\.                      |
| \\<      | 词首定位符          | \\<love                      |
| \\>      | 词尾定位符          | love\\>                      |
| \\(..\\) | 标签或分组的意思    | :% s/\\(172.16.130.\\)1/\15/ |
| x\\{m\\} | 字符x重复出现m次    | o\\{5\\}                     |



> .\*              任意多个字符
>
> [a-b0-9]   匹配a-b,0-9一个字符
>
> [^]             匹配不在指定范围的一个字符  
>
>   
>
> x\\{m\\}      字符 x 重复出现 m 次  , o\\{5\\} 
>
> x\\{m,\\}      字符 x 重复出现 m 次以上 , o\\{5,\\} 
>
> x\\{m,n\\}    字符 x 重复出现 m 到 n 次 , o\\{5,10\\}  



**===扩展正则表达式**

| 扩展元字符   | 功能                           | 示例                                         |
| ------------ | ------------------------------ | -------------------------------------------- |
| +            | 匹配前导符一次或多次(只是一次) | [a-z]+ove                                    |
| ?            | 匹配前导符零个或一个           | lo?ve                                        |
| a\|b         | 匹配a或b                       | love\|hate                                   |
| ()           | 组字符                         | loveable\|rs   love(able\|rs)    ov+   (ov)+ |
| (..)(..)\1\2 | 标签匹配字符                   | (love)able\1er                               |
| x{m}         | 字符 x 重复 m 次               | o{5}                                         |



> x{m} 字符 x 重复 m 次 , o{5} 
>
> x{m,} 字符 x 重复至少 m 次,  o{5,} 
>
> x{m,n} 字符 x 重复 m 到 n 次,  o{5,10} 



#### POSIX 字符类 

>[:alnum:]      字母与数字字符                   [[:alnum:]]+
>
>[:alpha:]        字母字符(包括大小写字母) [[:alpha:]]{4}
>
>[:digit:]           数字字母                              [[:digit:]]?
>
>[:lower:]         小写字母                               [[:lower:]]{5,}
>
>[:upper:]         大写字母                              [[:upper:]]+
>
>[:punct:]          标点符号                              [[:punct:]]
>
>**[:blank:]         空格与制表符                      [[:blank:]]\***
>
>**[:space:]         包括垂直制表符等所有空白[[:space:]]+**



> **空行的处理**

**1.空行**

/^$/

/^[[:blank:]]\*\$/    或    /^[[:space:]]\*\$/

```shell
[root@localhost scripts]# cat -n ff.txt 
     1	
     2	       
     3				
     4	   		
     5			   
     6	   		    		   
     7				     	   		
     8	#回车
     9	#空格
    10	#制表符
    11	#空格和制表符
    12	#制表符和空格
    13	#多个空格和制表符
    14	#多个制表符和空格
[root@localhost scripts]# grep "^$" ff.txt   #只取到了回车这一行

[root@localhost scripts]# grep "^[ \t]*$" ff.txt  #\t没有效果

[root@localhost scripts]# grep "^[ [:space:]]*$" ff.txt  #使用POSIX元字符

       
			
   		
		   
   		    		   
			     	   		
```



**2.注释行**

/^#/

/^[[:blank:]]*#/



**3.删除文件中空行的方法**

*1*.文件空行不含空格与tab的处理

`grep . test.txt `

*2*.文件空行含空格及tab的处理

因文件某些行是由空格和tab组成，使用上面的方法并不能过滤这些行。 

我们可以使用awk命令来删除含有空格和tab的空行 : 

`awk NF test.txt`



> awk中的内部变量 NF 是 number of fields 的意思，也就是当前这一行数据中字段的个数
>
> 原文解释就是：
>
> The variable NF is set to the total **number of fields** in the input record.
>
> 通常是用空格或制表符隔开的，那么也就是列数。
>
> 如下的一行数据
>
> 1 2 3 4 5 6 7
>
> 就有7列，当读取到这行数据时， NF就等于7



也可使用正则的方式

```shell
[root@localhost scripts]# grep -v "^[[:blank:]]*$" ff.txt 
#回车
#空格
#制表符
#空格和制表符
#制表符和空格
#多个空格和制表符
#多个制表符和空格
```

